# 第三章 研究方法 (Methodology)

## 3.1 方法论全景 (Methodological Panorama)

滑坡易发性评估（Landslide Susceptibility Assessment, LSA）本质上是一个复杂的时空模式识别问题。在火后环境中，这一问题变得尤为棘手，因为滑坡的发生不仅受控于千万年形成的静态地质背景（如岩性、坡度），更受到突发性火灾扰动（如植被移除、土壤硬化）的动态激发。传统的评估模型往往难以在物理机制上区分这两类因子的贡献，导致预测结果缺乏可解释性，且容易产生对地形因子的过度依赖。

为了解决上述挑战，本研究提出了一套融合物理感知与因果推理的深度图学习框架。如图 3-1 所示，该框架由三个紧密咬合的阶段构成：
1.  **物理感知的数据增强 (Physically-Perceptive Data Enhancement)**：摒弃传统的栅格单元，构建基于斜坡单元（Slope Unit）的非欧氏空间数据基底，并利用时序 InSAR 获得的形变速率场对历史滑坡编目进行物理一致性清洗，从源头消除标签噪声。
2.  **双流正交图卷积网络 (DSO-GCN)**：针对多源特征的共线性问题，设计双流架构分别编码静态与动态特征，并通过正交正则化（Orthogonal Regularization）强制两类特征在潜在空间中线性无关，实现特征层面的因果解耦。
3.  **物理约束因果解释器 (PCCE)**：在后处理阶段，引入水文流向掩码（Hydrological Flow Mask）约束图解释器的搜索空间，并通过反事实推理（Counterfactual Reasoning）量化火灾扰动的绝对致灾风险，最终生成具有物理意义的动态易发性区划图。

## 3.2 问题定义与图构建 (Problem Definition & Graph Construction)

### 3.2.1 滑坡易发性的图节点分类建模
传统的 LSA 研究通常将研究区划分为规则的栅格网格，并假设各网格之间是独立同分布（Independent and Identically Distributed, I.I.D.）的。然而，滑坡本质上是一个受空间拓扑严格控制的物理过程。例如，坡脚的开挖可能导致坡顶的失稳，上游的汇水直接影响下游的孔隙水压力。因此，将滑坡预测任务建模为图节点分类问题更符合地质客观规律。

我们将研究区域抽象为一个无向属性图 $G = (V, E, X)$：
*   **节点集 $V$**：包含 $N$ 个斜坡单元 $\{v_1, v_2, \dots, v_N\}$。斜坡单元是依据水文分界线（山脊线与山谷线）划分的地貌实体，相比栅格更能保持滑坡的物理完整性。
*   **边集 $E$**：描述单元间的空间连接或属性关联，用邻接矩阵 $A \in \mathbb{R}^{N \times N}$ 表示。
*   **特征矩阵 $X$**：$X \in \mathbb{R}^{N \times F}$，其中每个节点 $v_i$ 的特征向量 $x_i$ 被显式划分为两部分 $x_i = [x_i^S \parallel x_i^D]$。$x_i^S \in \mathbb{R}^{F_S}$ 代表静态环境因子（坡度、岩性、土壤类型等），$x_i^D \in \mathbb{R}^{F_D}$ 代表动态扰动因子（dNBR、dNDVI、降雨量等）。
*   **标签集 $Y$**：$Y \in \{0, 1\}^N$，其中 $y_i=1$ 表示单元发生滑坡，0 表示稳定。

目标是学习一个映射函数 $f: (A, X) \to \hat{Y}$，预测每个单元的滑坡概率 $P(y_i=1|G)$。

### 3.2.2 属性辅助的拓扑结构构建
在图神经网络（GNN）中，邻接矩阵 $A$ 决定了信息传播的路径。仅基于欧氏距离的 K 近邻（KNN）建图虽然捕捉了空间邻近性，却忽略了地质环境的非平稳性（Non-stationarity）。根据地理学第一定律，空间位置邻近且地理属性相似的单元，往往具有同质的致灾机理。

为了抑制噪声在异质单元间传播（例如，防止坚硬岩石单元的特征被错误地平滑到相邻的松散堆积体单元中），本研究构建了**属性辅助的空间-属性加权图**。节点 $i$ 与 $j$ 之间的边权重 $A_{ij}$ 定义为：

$$
A_{ij} = \underbrace{\exp\left(-\frac{d_{ij}^2}{2\sigma_d^2}\right)}_{\text{空间邻近性}} \cdot \underbrace{\left( \frac{1}{2} + \frac{x_i^S \cdot x_j^S}{2 \|x_i^S\| \|x_j^S\|} \right)}_{\text{属性同质性}}
$$

其中，第一项为基于重心欧氏距离 $d_{ij}$ 的高斯核函数，$\sigma_d$ 为带宽参数，用于控制空间影响范围；第二项为静态特征向量的余弦相似度（归一化至 [0, 1] 区间），用于衡量地质背景的相似性。只有当 $A_{ij}$ 大于设定阈值 $\epsilon$ 时，才会在节点 $i$ 和 $j$ 之间建立边连接。该策略确保了消息传递优先发生在“空间相邻且孕灾背景相似”的单元之间，增强了模型对局部地质环境的适应能力。

## 3.3 物理感知的数据增强 (Physically-Perceptive Data Enhancement)

### 3.3.1 斜坡单元特征张量化
基于 12.5m 分辨率 ALOS PALSAR DEM 提取水文流线，利用各向异性算法将研究区划分为 4235 个斜坡单元。针对每个单元，采用空间统计方法聚合多源异构数据：
*   **连续变量**（如坡度、高程、TRI、NDVI）：计算单元内部像元的均值（Mean），以平滑局部高频噪声，提取宏观地貌特征。
*   **离散变量**（如岩性、土地利用、土壤类型）：计算众数（Mode），代表该单元的主要属性类别。
最终形成的特征张量 $X$ 经过 Z-score 标准化处理，消除量纲差异，确保梯度下降的稳定性。

### 3.3.2 基于 InSAR 速率场的标签清洗算法
机器学习模型的鲁棒性高度依赖于标签质量。传统的历史滑坡清单往往基于光学遥感解译，存在“幸存者偏差”和“时效滞后”，难以区分“当前稳定”与“潜在隐患”。本研究引入 SBAS-InSAR 技术获取的地表形变速率场 $V_{defo}$，设计了一种双向标签清洗算法：

1.  **潜在隐患挖掘（False Negative Correction）**：
    对于编目中标记为“非滑坡”($y_i=0$) 的单元，计算其内部沉降最显著区域（Bottom 20% 像元）的平均速率 $v_i^{sub}$。
    $$ v_i^{sub} = \frac{1}{|P_{20\%}|} \sum_{k \in P_{20\%}} v_{i,k} $$
    若 $v_i^{sub} < -20 \text{ mm/yr}$（经验物理失稳阈值），则认为该单元虽然未发生灾难性破坏，但已处于蠕变状态，修正标签 $y_i \leftarrow 1$。
2.  **高置信度样本筛选（Noise Filtering）**：
    对于负样本，仅保留 $|v_i^{sub}| < 5 \text{ mm/yr}$ 的单元参与训练，确保负样本不仅在历史上未滑坡，且在物理上当前是稳定的。介于 $[5, 20]$ 之间的样本被视为“模糊区”，在训练中剔除，以防止模型学习到模棱两可的特征模式。

## 3.4 双流正交图卷积网络 (DSO-GCN)

### 3.4.1 传统 GNN 的局限性
传统的图卷积网络（GCN）将所有特征 $X$ 拼接后输入单一通道进行编码。在火后滑坡场景中，静态因子（如陡坡）与动态因子（如高火烈度）往往在空间上高度重叠（共线性）。模型在训练过程中倾向于依赖容易学习且分布稳定的静态地形特征来最小化损失，而忽略动态火灾因子的边际贡献。这种“捷径学习（Shortcut Learning）”现象导致模型无法回答“火灾究竟增加了多少风险”这一因果问题，也难以泛化到地貌相似但未过火的区域。

### 3.4.2 双流特征编码器设计 (Dual-Stream Feature Encoder)
为了在架构层面实现特征解耦，DSO-GCN 采用了**双流（Dual-Stream）**设计。模型包含两个参数独立的图卷积通道，分别负责提取静态环境与动态扰动的高阶特征。

令 $\tilde{A} = \hat{D}^{-1/2} \hat{A} \hat{D}^{-1/2}$ 为归一化拉普拉斯矩阵。第 $l$ 层的特征传播规则如下：

**静态流 (Static Stream)**：旨在捕捉地形地貌的深层空间结构。
$$ H_S^{(l+1)} = \sigma \left( \tilde{A} H_S^{(l)} W_S^{(l)} \right) $$

**动态流 (Dynamic Stream)**：旨在捕捉火灾扰动的空间扩散模式。
$$ H_D^{(l+1)} = \sigma \left( \tilde{A} H_D^{(l)} W_D^{(l)} \right) $$

其中，$H_S^{(0)} = X^S$，$H_D^{(0)} = X^D$。$W_S^{(l)}$ 和 $W_D^{(l)}$ 分别为两个流的可学习权重矩阵，$\sigma$ 为 ReLU 激活函数。通过这种设计，动态流被强制专注于从火灾因子中提取风险模式，而不受地形特征的直接干扰。

### 3.4.3 潜在空间正交正则化机制 (Orthogonal Regularization)
仅有双流架构并不足以保证解耦，因为深层网络可能通过动态流“隐式”地重建地形信息（例如，dNBR 与坡度存在统计相关）。为了彻底消除冗余，我们在损失函数中引入**正交正则化（Orthogonal Regularization）**。

该机制强制要求静态流的最终嵌入 $H_S^{(L)}$ 与动态流的嵌入 $H_D^{(L)}$ 在希尔伯特空间中相互垂直。正交损失 $L_{orth}$ 定义为两个特征矩阵的相互关矩阵的 Frobenius 范数：

$$ L_{orth} = \frac{1}{N^2} \left\| (H_S^{(L)})^\top H_D^{(L)} \right\|_F^2 $$

其中 $\frac{1}{N^2}$ 为归一化因子。当 $L_{orth} \to 0$ 时，意味着静态特征与动态特征的协方差趋近于零，即两者线性无关。这从数学上保证了模型所学习到的“动态风险”是不包含“静态背景风险”的纯净增量。

### 3.4.4 模型训练与优化
模型的最终预测由两个流的输出拼接后，经全连接层（MLP）分类器得到：
$$ \hat{Y} = \text{Softmax}\left( \text{MLP}( [H_S^{(L)} \parallel H_D^{(L)}] ) \right) $$

总损失函数 $L_{total}$ 由滑坡分类的主任务损失（加权交叉熵，$L_{CE}$）和正交正则化项组成，通过超参数 $\lambda$ 平衡两者的权重：
$$ L_{total} = L_{CE}(Y, \hat{Y}) + \lambda \cdot L_{orth} $$
其中，加权交叉熵用于解决正负样本不平衡问题。

## 3.5 物理约束因果解释器 (PCCE)

### 3.5.1 水文流向掩码构建 (Hydrological Flow Mask)
图神经网络解释器（如 GNNExplainer）通常通过寻找最大互信息子图来解释预测结果。然而，纯数据驱动的搜索可能产生违反物理常识的解释。例如，统计上可能发现下游单元的特征与上游单元的滑坡高度相关，但这违背了重力控制的物质运移规律。

PCCE 引入了**水文流向掩码**来约束解释空间。基于 DEM 计算单元 $i$ 与 $j$ 的相对高差 $\Delta h_{ij} = E_i - E_j$。我们定义流向掩码矩阵 $M_{flow}$：
$$ M_{flow, ij} = \begin{cases} 1, & \text{if } \Delta h_{ij} > 0 \text{ (上游指向下游)} \\ 0, & \text{otherwise} \end{cases} $$

在解释器优化边掩码 $M_{edge}$ 的过程中，将其与 $M_{flow}$ 进行阿达玛积（Hadamard Product）：$M_{final} = M_{edge} \odot M_{flow}$。这一硬约束强制切断了所有逆重力方向的虚假因果连接，确保解释结果符合地表径流与物质运移的物理规律。

### 3.5.2 反事实概率下降 (CPD) 量化方法
为了量化火灾因子的绝对致灾贡献，PCCE 采用**反事实推理（Counterfactual Reasoning）**。其核心逻辑是回答：“如果没有发生火灾，该单元的滑坡概率会下降多少？”

对于预测为高风险的单元 $i$，我们进行如下干预实验：
1.  **事实推断 (Factual Inference)**：输入原始特征 $x_i = [x_i^S, x_i^D]$，计算风险概率 $P_{orig} = P(y_i=1 \mid x_i)$。
2.  **反事实干预 (Counterfactual Intervention)**：保持静态特征 $x_i^S$ 不变，将动态特征 $x_i^D$ 强制置零（模拟未过火状态），构造反事实特征 $x_i^{cf} = [x_i^S, \mathbf{0}]$，计算反事实概率 $P_{cf} = P(y_i=1 \mid x_i^{cf})$。
3.  **因果效应量化**：计算反事实概率下降（Counterfactual Probability Drop, CPD）：
    $$ \text{CPD}_i = P_{orig} - P_{cf} $$

CPD 值直接反映了火灾扰动对滑坡易发性的边际贡献。基于 CPD 分布，我们将高易发区划分为“静态主导型”（CPD $\approx$ 0）与“动态诱发型”（CPD $\gg$ 0），从而揭示火后滑坡的动态激活机制。
