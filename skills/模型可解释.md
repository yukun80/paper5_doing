# 第一部分：从“单点解释”迈向“多尺度机理分析” (Interpretability)

GNNExplainer 原生是为解释“单个节点的预测”设计的（Local Explanation）。为了提升论文的档次，我们必须将其扩展为**“单点微观机理 + 区域宏观模式”**的双层分析框架，并设计高质量的图表。

#### 1. 节点尺度 (Micro-Level)：从“Feature Mask”到“致灾模式”

不要只展示 Feature Mask 的条形图，要结合地理场景。

* **分析策略：** 挑选 2-3 个典型的 True Positive 案例（如：一个位于重度火烧迹地的滑坡，一个位于非火烧区但降雨集中的滑坡）。
* **SCI 配图设计建议：**
  * **图 A (拓扑子图可视化)：** 绘制中心节点及其高权重邻居（Edge Mask > 阈值）。**创新点：** 节点的颜色代表 `dNBR`（火烧强度），边的粗细代表 Mask 权重。这能直观展示“火烧严重的邻居节点是如何通过图结构‘传染’风险给中心节点的”。
  * **图 B (特征雷达图对比)：** 不要用简单的 Bar Chart。使用**雷达图**对比该节点在“动态因子（dNDVI, dNBR）”与“静态因子（Slope, Lithology）”上的归因权重。
    * *案例 1：* 雷达图偏向动态轴 -> 证明是“火灾-降雨”诱发型。
    * *案例 2：* 雷达图偏向静态轴 -> 证明是“地形-地质”控制型。

#### 2. 区域尺度 (Macro-Level)：从“个例”到“空间分异规律”

这是提升论文深度的关键。我们需要**聚合**所有高风险节点的解释结果。

* **分析策略：**

  * **全局特征重要性排序：** 对测试集中所有 TP 节点（如 500 个）运行 Explainer，计算 Feature Mask 的平均值和方差。使用 **Boxplot** 展示，证明在火后区域，动态因子的整体重要性显著上升。
  * **致灾因子空间分布图 (Spatial Pattern of Dominant Drivers)：**
    * 对每个像素（SU），根据 GNNExplainer 输出的 Mask，判定其主导因子。
    * **分类标准：** 若 **$\sum \text{DynamicMask} > \sum \text{StaticMask}$**，标记为“动态驱动型”；反之标记为“静态驱动型”。
    * **制图：** 绘制一张雅江县的“滑坡致灾机制空间分区图”。
* **SCI 配图设计建议：**

  * 这是一张地图。底图透明，上覆颜色图层：按照坡面单元进行划分，红色区域代表“动态因子主导区”，蓝色区域代表“静态因子非地形因子主导区”，灰色代表“地形主导区”。

# 对前面区域尺度 (Macro-Level)的优化方案

简单地比较 `Sum(Dynamic Mask)` 与 `Sum(Static Mask)` 谁大谁小（即“主导因子”分类），确实可能存在问题：因为在绝大多数滑坡中，坡度（Slope）等地形因子的贡献度可能始终是基础且巨大的（Mask值很高），导致简单的二元分类会将几乎所有区域都划分为“静态主导”，从而掩盖了动态因子的 **边际贡献（Marginal Contribution）** 。

因此，原本的“区域宏观分析”方案 **必须优化** 。我们需要从**“总量比较” **转向** “增量贡献” **或** “敏感性分析”**。以下是优化后的建议：

### 优化核心理念：从“谁主导”转向“谁放大” (From Dominance to Amplification)

我们不再试图证明动态因子比地形因子“更重要”，而是要展示：**在地形因子的基础上，动态因子额外贡献了多少风险，或者将风险放大了多少倍。**

#### 优化方案 1：构建“动态致灾敏感度”指数 (Dynamic Sensitivity Index, DSI)

不要使用二元分类图，而是计算一个连续的指标，反映该位置对火灾扰动的敏感程度。

* 定义公式：

  $$
  DSI = \frac{\sum Mask_{dynamic}}{\sum Mask_{static} + \sum Mask_{dynamic}}
  $$

  或者更物理的定义（基于概率变化）：

  $$
  DSI = P(Landslide | X_{static}, X_{dynamic}) - P(Landslide | X_{static}, X_{dynamic}=0)
  $$

  (注：第二种需要进行 Counterfactual 推理，GNNExplainer 可以通过 Mask 掉动态特征来实现)
* **可视化策略：**

  * 绘制一张  **“火后易发性增益图”** 。
  * **图例设计：** 颜色深浅代表动态因子的贡献比例（例如 0% - 40%）。
  * **预期发现：** 你可能会发现，在极陡峭区域（Slope > 50°），静态因子极强，DSI 较低；而在**中等坡度（Slope 25°-40°）且火烧严重**的区域，DSI 最高。这恰恰证明了火灾降低了滑坡发生的临界阈值（Threshold Lowering Effect）。

#### 优化方案 2：分层交互分析 (Stratified Interaction Analysis) —— SCI 配图杀手锏

由于地形是核心，我们应该在**控制地形变量**的前提下，看动态因子的表现。

* **分析策略：**
  1. 将研究区按坡度分为几组：平缓 (<15°)、中等 (15-30°)、陡峭 (>30°)。
  2. 在每一组内，分别绘制 dNBR 的 Feature Mask 权重分布（Boxplot）。
* **配图设计：**
  * **X轴：** 坡度分级。
  * **Y轴：** dNBR 的 GNNExplainer 重要性权重。
  * **科学故事：** 这张图能回答：“火灾究竟是在所有坡度上都危险，还是只在特定坡度区间（如临界不稳定坡度）起到了‘压死骆驼的最后一根稻草’的作用？”

#### 3. 优化方案 3：修正后的“致灾模式分区图” (Refined Zoning Map)

放弃简单的“静态 vs 动态”二分法，采用  **“基础-触发”耦合分类体系** ：

* **类型 A：静态高易发型 (Static-Dominant)**
  * 定义：地形因子 Mask 极高，动态因子 Mask 极低。
  * 物理含义：本身就极易滑坡，有没有火灾都一样。
* **类型 B：动态诱发型 (Dynamic-Triggered)**
  * 定义：地形因子 Mask 中等（本不该滑），但动态因子 Mask 显著（> 阈值，如 20%）。
  * 物理含义：火灾破坏了原本的临界平衡状态。这是你研究最需要捕捉的**“新增隐患点”**。
* **类型 C：复合驱动型 (Compound-Driven)**
  * 两者贡献都高。

实施建议：

在 explain_landslide.py 导出 CSV 后，在绘图脚本中：

1. **不要**直接画 `Dynamic > Static` 的二值图。
2. **计算** `Ratio = Dynamic_Mask_Sum / Total_Mask_Sum`。
3. **筛选** `Ratio > 0.15` (假设阈值) 且 `Prediction_Probability > 0.8` 的区域，标记为“火后敏感区”。
4. 将这些区域与 InSAR 形变图叠加，如果吻合，就完美证明了**“GNNExplainer 找到了那些因火灾而变得不稳定的斜坡”**。

总结：

你的直觉是对的。不要试图撼动地形因子的核心地位，而是要量化动态因子的**“边际增量”**。这种“地形为底，火灾为媒”的解释逻辑，比单纯的“因子赛跑”更符合地学机理，也更容易被顶刊 Reviewer 接受。
